V(ioutfriends)$gender[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$gender
V(ioutfriends)$profession[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$profession
V(ioutfriends)$seniority[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$seniority
V(ioutfriends)$uname[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$screen_name
#V(ioutfriends)$name[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$name
}
netoutfriends <- asNetwork(ioutfriends)
netoutfriends
library(tidyverse)
library(igraph)
library(statnet)
library(intergraph)
library(GGally)
library(RColorBrewer)
akp <- readRDS("/Users/hhekim/Twitter_Network/AKP_MYK/_akp_myk_friends.rds")
chp <- readRDS("/Users/hhekim/Twitter_Network/CHP_MYK/_chp_myk_friends.rds")
ip <- readRDS("/Users/hhekim/Twitter_Network/IP_MYK/_ip_myk_friends.rds")
mhp <- readRDS("/Users/hhekim/Twitter_Network/MHP_MYK/_mhp_myk_friends.rds")
hdp <- readRDS("/Users/hhekim/Twitter_Network/HDP_MYK/_hdp_myk_friends.rds")
partiler <- bind_rows(akp,chp,ip,mhp,hdp)
partiler$pos <- NULL
###Get user information for all followed users
# followed_user_id <- str_replace_all(partiler$user_id,"@", "")
# followed_user_id <- unique(followed_user_id)
# users_df <- lookup_users(followed_user_id)
# saveRDS(users_df, "/Users/hhekim/Twitter_Network/IP_MYK/_all_followed_users.rds")
akp_myk <- read_delim("/Users/hhekim/Twitter_Network/AKP_MYK/_AKP_MYK.txt", delim=",", col_names=TRUE,
col_types = "cccccccccc")
chp_myk <- read_delim("/Users/hhekim/Twitter_Network/CHP_MYK/_CHP_MYK.txt", delim=",", col_names=TRUE,
col_types = "cccccccccc")
ip_myk <- read_delim("/Users/hhekim/Twitter_Network/IP_MYK/_IP_MYK.txt", delim=",", col_names=TRUE,
col_types = "cccccccccc")
mhp_myk <- read_delim("/Users/hhekim/Twitter_Network/MHP_MYK/_MHP_MYK.txt", delim=",", col_names=TRUE,
col_types = "cccccccccc")
hdp_myk <- read_delim("/Users/hhekim/Twitter_Network/HDP_MYK/_HDP_MYK.txt", delim=",", col_names=TRUE,
col_types = "cccccccccc")
all_myk <- bind_rows(akp_myk,chp_myk,ip_myk,mhp_myk,hdp_myk)
# Data frame of politicians
partiler_myk <- filter(partiler, user_id %in% all_myk$id)
new_df <- partiler_myk
new_df[] <- all_myk$screen_name[match(unlist(partiler_myk),all_myk$id)]
partiler_myk$user_id <- new_df$user_id
partiler_myk$pos <- NULL
# add alliances as edge attribute
for(i in 1:length(partiler_myk$user)){
if(all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party){
partiler_myk$ally[i] <- 3
}else if((all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "AKP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "MHP") | (all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "MHP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "AKP")){
partiler_myk$ally[i] <- 2
}else if((all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "CHP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "IP") | (all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "IP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "CHP")){
partiler_myk$ally[i] <- 2
}else if((all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "CHP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "HDP") | (all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "HDP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "CHP")){
partiler_myk$ally[i] <- 1
}else if((all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "MHP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "IP") | (all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "IP" & all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "MHP")){
partiler_myk$ally[i] <- 1
}else{
partiler_myk$ally[i] <- 0
}
}
for(i in 1:length(partiler_myk$user)){
if((all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "AKP" &
all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "MHP") |
(all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "MHP" &
all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "AKP")){
partiler_myk$alliance[i] <- "CUMHUR"
}else if((all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "CHP" &
all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "IP") |
(all_myk[all_myk$screen_name == partiler_myk$user[i],]$party == "IP" &
all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party == "CHP")){
partiler_myk$alliance[i] <- "MILLET"
}else{
partiler_myk$alliance[i] <- NA
}
}
rm(list = c("akp","akp_myk","chp","chp_myk","ip","ip_myk","mhp","mhp_myk","new_df","hdp","hdp_myk"))
myk <- all_myk %>% select(screen_name,fname=name,alias,gender,position=pos,party)
iallparties <- graph_from_data_frame(partiler_myk, vertices = myk)
netallparties <- asNetwork(iallparties)
set.vertex.attribute(netallparties, "degree", degree(netallparties, rescale = TRUE))
set.vertex.attribute(netallparties, "betweenness", betweenness(netallparties, rescale = TRUE))
#summary(netfriends_myk)
netallparties
summary(netallparties)
netallparties %v% "name"
netallparties %v% "vertex.name"
netallparties %v% "fname"
netallparties %v% "party"
View(partiler_myk)
outfriends <- setNames(data.frame(matrix(ncol = 3, nrow = 0)), c("user","friend","ally"))
for(i in 1:length(partiler_myk$user)){
a <- all_myk[all_myk$screen_name == partiler_myk$user[i],]$party
b <- all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party
if(a != b){
tempdf <- data.frame(user = partiler_myk$user[i], user_id = partiler_myk$user_id[i],
ally = partiler_myk$ally[i])
outfriends <- rbind(outfriends, tempdf)
}
}
outfriends <- setNames(data.frame(matrix(ncol = 3, nrow = 0)), c("user","user_id","ally"))
outfriends <- setNames(data.frame(matrix(ncol = 3, nrow = 0)), c("user","friend","ally"))
for(i in 1:length(partiler_myk$user)){
a <- all_myk[all_myk$screen_name == partiler_myk$user[i],]$party
b <- all_myk[all_myk$screen_name == partiler_myk$user_id[i],]$party
if(a != b){
tempdf <- data.frame(user = partiler_myk$user[i], user_id = partiler_myk$user_id[i],
ally = partiler_myk$ally[i])
outfriends <- rbind(outfriends, tempdf)
}
}
#outfriends <- setNames(data.frame(matrix(ncol = 3, nrow = 0)), c("user","user_id","ally"))
ioutfriends <- graph_from_data_frame(outfriends)
for(i in 1:length(V(ioutfriends)$name)){
V(ioutfriends)$party[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$party
V(ioutfriends)$alias[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$alias
V(ioutfriends)$gender[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$gender
V(ioutfriends)$profession[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$profession
V(ioutfriends)$seniority[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$seniority
V(ioutfriends)$uname[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$screen_name
#V(ioutfriends)$name[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$name
}
netoutfriends <- asNetwork(ioutfriends)
set.vertex.attribute(netoutfriends, "degree", degree(netoutfriends, rescale = TRUE))
set.vertex.attribute(netoutfriends, "betweenness", betweenness(netoutfriends, rescale = TRUE))
set.vertex.attribute(netoutfriends, "closeness", closeness(netoutfriends, rescale = TRUE))
set.vertex.attribute(netoutfriends, "eigenvector", evcent(netoutfriends, rescale = TRUE))
summary(netoutfriends)
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE, label.cex = deg*40, label.pos = 2,
vertex.cex=deg*100,vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
netoutfriends %v% "alias"
deg
deg*40
deg*100
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
netoutfriends %e% "ally")
netoutfriends %e% "ally"
shape
View(outfriends)
View(all_myk)
ioutfriends <- graph_from_data_frame(outfriends)
for(i in 1:length(V(ioutfriends)$name)){
V(ioutfriends)$party[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$party
V(ioutfriends)$alias[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$alias
V(ioutfriends)$gender[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$gender
V(ioutfriends)$profession[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$profession
V(ioutfriends)$seniority[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$seniority
V(ioutfriends)$uname[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$screen_name
V(ioutfriends)$position[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$pos
#V(ioutfriends)$name[i] <- all_myk[all_myk$screen_name==V(ioutfriends)$name[i],]$name
}
netoutfriends <- asNetwork(ioutfriends)
set.vertex.attribute(netoutfriends, "degree", degree(netoutfriends, rescale = TRUE))
set.vertex.attribute(netoutfriends, "betweenness", betweenness(netoutfriends, rescale = TRUE))
set.vertex.attribute(netoutfriends, "closeness", closeness(netoutfriends, rescale = TRUE))
set.vertex.attribute(netoutfriends, "eigenvector", evcent(netoutfriends, rescale = TRUE))
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, label.cex = deg*40,vertex.cex=deg*100
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, label.cex = deg*40,vertex.cex=deg*100,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, label.cex = deg*100,vertex.cex=deg*100,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, label.cex = deg*1000,vertex.cex=deg*1000,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, label.cex = deg*200,vertex.cex=deg*100,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
deg
deg*100
netoutfriends %v% "betweenness"
netoutfriends %v% "eigenvector"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "circle",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "eigen",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "hall",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "kamadakawai",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "mds",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "princoord",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "random",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "spring",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
#pos <- as.factor(get.vertex.attribute(netallparties, "position"))
deg <- degree(netoutfriends, cmode = "indegree", rescale = TRUE)
par(mar=c(0,0,0,0))
gplot(netoutfriends, gmode="digraph", usearrows=TRUE, label=netoutfriends %v% "alias",
displaylabels=TRUE,  label.pos = 2, mode = "target",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), arrowhead.cex = 0.7,
edge.lwd=0.5,edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],jitter = TRUE)
legend("right",legend=c("Non-Ally","Close", "Ally"),col=my_pal2,pch=19,pt.cex=2,title = "Edges")
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes")
A <- get.adjacency(netoutfriends, sparse = FALSE)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
sna::gplot.target(g, degree(g), main="Degree",
circ.col="skyblue", usearrows = FALSE,
circ.lab.col = "darkgray",
vertex.col=c("blue", rep("red", 32), "yellow"),
edge.col="darkgray", displaylabels = TRUE,
label = f, label.cex=0.5,)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
par(mar=c(1,1,1,1))
sna::gplot.target(g, degree(g), main="Degree",
circ.col="skyblue", usearrows = FALSE,
circ.lab.col = "darkgray",
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],
displaylabels = TRUE,
label = f, label.cex=0.5,)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
par(mar=c(1,1,1,1))
sna::gplot.target(g, degree(g),
circ.col="skyblue", usearrows = TRUE, arrowhead.cex = 0.7,
circ.lab = FALSE,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape),
edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],
displaylabels = TRUE,
label = f, label.cex=0.5,)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
par(mar=c(1,1,1,1))
sna::gplot.target(g, degree(g),
circ.col="skyblue", circ.lab = FALSE,
usearrows = TRUE, arrowhead.cex = 0.7,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape), label.cex = 1.1,
edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],
displaylabels = TRUE,
label = f, label.cex=0.5,)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
par(mar=c(1,1,1,1))
sna::gplot.target(g, degree(g),
circ.col="skyblue", circ.lab = FALSE,
usearrows = TRUE, arrowhead.cex = 0.7,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape),
label=netoutfriends %v% "alias", label.cex = 1.1,
edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],
displaylabels = TRUE,
label = f, label.cex=0.5,)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
par(mar=c(1,1,1,1))
sna::gplot.target(g, degree(g),
circ.col="skyblue", circ.lab = FALSE,
usearrows = TRUE, arrowhead.cex = 0.7,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape),
edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],
displaylabels = TRUE,
label = f, label.cex=0.7,)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
par(mar=c(1,1,1,1))
sna::gplot.target(g, degree(g),
circ.col="skyblue", circ.lab = FALSE,
usearrows = TRUE, arrowhead.cex = 0.7,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape),
edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],
displaylabels = TRUE,
label = f, label.cex=0.7,label.pos = 2)
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes", box.col="white",cex = 0.8)
A <- get.adjacency(ioutfriends, sparse = FALSE)
g <- network::as.network.matrix(A)
f <- netoutfriends %v% "alias"
my_pal <- c("#FDAE61","#D73027","#5AAE61","#4575B4","#8C510A")
my_pal2 <- c("#FB9A99","#FEE090","#B2DF8A")
shape <- ifelse(netoutfriends %v% "position" == "P",3,8)
par(mar=c(1,1,1,1))
sna::gplot.target(g, degree(g),
circ.col="skyblue", circ.lab = FALSE,
usearrows = TRUE, arrowhead.cex = 0.7,
vertex.col=my_pal[as.factor(netoutfriends %v% "party")],
vertex.sides = as.integer(shape),
edge.col=my_pal2[as.factor(netoutfriends %e% "ally")],
displaylabels = TRUE,
label = f, label.cex=0.7,label.pos = 2)
legend("left",legend=c("AKP","CHP","HDP", "IP","MHP"),col=my_pal,pch=19,pt.cex=2,title = "Nodes", box.col="white",cex = 0.8)
rmarkdown::render("/Users/hhekim/RDir/SNA-Twitter-Pol-Alliance/Manuscript.Rmd")
mixingmatrix(netoutfriends, "party")[[2]]
library(readxl)
library(dplyr)
url <- paste("https://www.ecdc.europa.eu/sites/default/files/documents/COVID-19-geographic-disbtribution-worldwide-",Sys.Date(),".xlsx", sep = "")
destfile <- "covid.xlsx"
curl::curl_download(url, destfile)
covid <- read_excel(destfile)
countries <- read.csv("/Users/hhekim/RDir/country-and-continent-codes-list-csv_csv.csv",
header = TRUE, sep = ",")
countries <- countries %>%
select(Continent_Name, geoId = Two_Letter_Country_Code)
covid <- left_join(covid, countries, by = "geoId")
covid <- as.data.frame(lapply(covid, function(x) {
if (inherits(x, "POSIXt")) as.Date(x) else x }))
covid <- covid %>% group_by(countriesAndTerritories) %>%
arrange(countriesAndTerritories,dateRep) %>%
mutate(csumcases = cumsum(cases), csumdeaths = cumsum(deaths))
covid <- covid %>% filter(csumdeaths > 0)
covid <- covid %>% arrange(dateRep) %>% group_by(geoId) %>% mutate(day_counter = row_number())
save(covid, file = "/Users/hhekim/RDir/COVID/Covid19/covid.RData")
shiny::runApp('RDir/COVID/Covid19')
